<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Weekplan.ai — Custom Allergy-Friendly Meal Plans</title>
  <meta name="description" content="AI-built weekly meal plans and recipes tailored to your allergies, goals, and tastes." />
  <link rel="stylesheet" href="/styles.css" />
  <link rel="icon" href="https://img.icons8.com/color/96/meal.png" />
</head>
<body>
  <!-- Sticky NAV ONLY -->
  <header class="wrap">
    <nav class="nav">
      <a class="brand" href="/">Weekplan<span>.ai</span></a>
      <button class="menu-toggle" aria-label="Open menu">☰</button>
      <div class="links">
        <a href="#features">Features</a>
        <a href="#how">How it works</a>
        <a href="#pricing">Pricing</a>
        <a class="login-btn" href="/weekplan.html">Log in</a>
      </div>
    </nav>
    <!-- mobile dropdown -->
    <div class="mobile-menu" id="mobile-menu">
      <a href="#features">Features</a>
      <a href="#how">How it works</a>
      <a href="#pricing">Pricing</a>
      <a class="login-btn" href="/weekplan.html">Log in</a>
    </div>
  </header>

  <main class="wrap">
    <!-- HERO -->
    <section class="hero two-col" id="home">
      <div>
        <h1><span id="rot-word" class="rot" style="color:#2563eb">Allergy-friendly</span> meal plans, <em>just for you.</em></h1>
        <p class="sub">Tell us your allergens, goals, and tastes. Our AI builds a 7-day plan with recipes you can drag, drop, and tweak in seconds.</p>
        <div class="cta-row" style="display:flex;gap:10px;flex-wrap:wrap">
          <a class="btn" href="/weekplan.html">Start free</a>
          <a class="btn alt" href="#features">See features</a>
        </div>
        <ul class="badges">
          <li>Gluten-free</li>
          <li>Dairy-free</li>
          <li>Nut-free</li>
          <li>Egg-free</li>
          <li>Vegan options</li>
        </ul>
      </div>
      <div class="hero-img">
        <img src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?q=80&w=1200&auto=format&fit=crop" alt="Week plan preview" />
      </div>
    </section>

    <!-- FEATURES -->
    <section id="features" class="card">
      <h2>Why Weekplan.ai</h2>
      <ul class="feature-grid">
        <li>
          <img src="https://images.unsplash.com/photo-1521302200778-33500795e6dc?q=80&w=800&auto=format&fit=crop" alt="">
          <h3>Personalized to your needs</h3>
          <p>Allergens, goals, time, budget—every plan is built around you.</p>
        </li>
        <li>
          <!-- updated image -->
          <img src="https://images.unsplash.com/photo-1512621776951-a57141f2eefd?q=80&w=800&auto=format&fit=crop" alt="">
          <h3>Drag & drop planner</h3>
          <p>Swap, edit, or remove meals with one click. Your grocery list updates instantly.</p>
        </li>
        <li>
          <!-- updated image -->
          <img src="https://images.unsplash.com/photo-1478145046317-39f10e56b5e9?q=80&w=800&auto=format&fit=crop" alt="">
          <h3>Family-friendly recipes</h3>
          <p>Curated, quick, and tasty recipes with allergy tags and prep times.</p>
        </li>
      </ul>
    </section>

    <!-- LIBRARY -->
    <section id="library" class="card library">
      <div class="lib-head">
        <div>
          <h2>Recipe library</h2>
          <p class="muted">Build your own <strong>cookbooks</strong> and <strong>collections</strong>, rate community recipes, and save your adjusted versions. Your favorites appear here and in the planner.</p>
        </div>
        <div class="lib-actions">
          <input id="search" type="search" placeholder="Search recipes…" />
          <a class="btn small" href="/ai-recipe-planner.html">Generate with AI</a>
        </div>
      </div>

      <div class="lib-layout">
        <!-- Sidebar -->
        <aside class="side">
          <h4>Categories</h4>
          <ul id="cat-list" class="cat-list">
            <!-- filled by JS -->
          </ul>

          <h4>Your space</h4>
          <ul class="quick">
            <li><button class="pill" data-view="all">All recipes</button></li>
            <li><button class="pill" data-view="favorites">Favorites</button></li>
            <li><button class="pill" data-view="mine">Your adjusted</button></li>
          </ul>
          <p class="muted" style="font-size:13px">Sign in to sync your library cross-device.</p>
        </aside>

        <!-- Grid -->
        <div class="lib-main">
          <div id="results-count" class="muted" style="margin-bottom:8px"></div>
          <div id="recipes" class="recipes-grid">
            <!-- cards via JS -->
          </div>
        </div>
      </div>
    </section>

    <!-- HOW -->
    <section id="how" class="card">
      <h2>How it works</h2>
      <ol class="steps">
        <li><strong>Tell us your allergens</strong> (e.g., gluten, dairy, nuts) and goals.</li>
        <li><strong>Generate a plan</strong> (7 meals with images and instructions).</li>
        <li><strong>Drag, drop, and edit</strong> until it’s perfect—then export or share.</li>
      </ol>
    </section>

    <!-- PRICING -->
    <section id="pricing" class="card">
      <h2>Pricing</h2>
      <div class="price-grid">
        <div class="tile">
          <h3>Free</h3>
          <p>Generate plans, drag & drop, save one active plan.</p>
          <p class="big">$0</p>
          <a class="btn" href="/weekplan.html">Start</a>
        </div>
        <div class="tile">
          <h3>Plus</h3>
          <p>Multiple saved plans, favorites, and premium recipes.</p>
          <p class="big">$5 / mo</p>
          <a class="btn alt" href="/weekplan.html">Try it</a>
        </div>
      </div>
      <p class="muted">We’re in open alpha—pricing may change; early users keep early pricing.</p>
    </section>
  </main>

  <footer class="wrap footer">
    <small>© <span id="y"></span> Weekplan.ai</small>
  </footer>

  <!-- Scripts -->
  <script>
    // year
    document.getElementById('y').textContent = new Date().getFullYear();

    // mobile menu
    const mm = document.getElementById('mobile-menu');
    document.querySelector('.menu-toggle').addEventListener('click', () => {
      mm.classList.toggle('open');
    });

    // rotating hero word with colors
    const rotWords = [
      { text: "Allergy-friendly", color: "#2563eb" },
      { text: "Fitness",          color: "#16a34a" },
      { text: "Weightloss",       color: "#f59e0b" },
      { text: "Family",           color: "#ef4444" },
      { text: "Budget",           color: "#0ea5e9" },
      { text: "High-protein",     color: "#9333ea" }
    ];
    const rot = document.getElementById('rot-word');
    let ri = 0;
    setInterval(()=>{
      rot.classList.add('fade-out');
      setTimeout(()=>{
        ri = (ri+1) % rotWords.length;
        rot.textContent = rotWords[ri].text;
        rot.style.color = rotWords[ri].color;
        rot.classList.remove('fade-out');
        rot.classList.add('fade-in');
        setTimeout(()=>rot.classList.remove('fade-in'), 350);
      }, 250);
    }, 2200);

    // ---------- Library demo data + UI ----------
    const demo = [
      {id:'r1',  title:'Mediterranean Quinoa Salad', cats:['salad','gluten-free','vegetarian'], rating:4, mine:false, img:'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?q=80&w=800&auto=format&fit=crop'},
      {id:'r2',  title:'Creamy Tomato Pasta (GF)',   cats:['pasta','gluten-free','quick'],     rating:5, mine:true,  img:'https://images.unsplash.com/photo-1512621776951-a57141f2eefd?q=80&w=800&auto=format&fit=crop'},
      {id:'r3',  title:'Coconut Lentil Curry',       cats:['curry','vegan','budget'],          rating:5, mine:false, img:'https://images.unsplash.com/photo-1617196037304-9a851b1cfa2c?q=80&w=800&auto=format&fit=crop'},
      {id:'r4',  title:'Salmon Traybake',            cats:['fish','family','quick'],           rating:4, mine:false, img:'https://images.unsplash.com/photo-1506086679525-9d3a8e4d1f04?q=80&w=800&auto=format&fit=crop'},
      {id:'r5',  title:'Chickpea Tabbouleh',         cats:['salad','vegan','budget'],          rating:4, mine:true,  img:'https://images.unsplash.com/photo-1490645935967-10de6ba17061?q=80&w=800&auto=format&fit=crop'},
      {id:'r6',  title:'Turkey Lettuce Wraps',       cats:['high-protein','low-carb','quick'], rating:3, mine:false, img:'https://images.unsplash.com/photo-1504674900247-0877df9cc836?q=80&w=800&auto=format&fit=crop'},
      {id:'r7',  title:'Roasted Cauli Bowls',        cats:['vegetarian','roast','family'],     rating:4, mine:false, img:'https://images.unsplash.com/photo-1543352634-11a8e2d3d6c4?q=80&w=800&auto=format&fit=crop'},
      {id:'r8',  title:'Garlic Shrimp Zoodles',      cats:['fish','low-carb','quick'],         rating:5, mine:false, img:'https://images.unsplash.com/photo-1478145046317-39f10e56b5e9?q=80&w=800&auto=format&fit=crop'},
      {id:'r9',  title:'Overnight Oats',             cats:['breakfast','budget','vegetarian'], rating:4, mine:false, img:'https://images.unsplash.com/photo-1476127391220-4f9e1f0adf7b?q=80&w=800&auto=format&fit=crop'},
      {id:'r10', title:'Chicken & Quinoa Bowls',     cats:['high-protein','family'],           rating:4, mine:false, img:'https://images.unsplash.com/photo-1512058564366-18510be2db19?q=80&w=800&auto=format&fit=crop'}
    ];

    const recipesEl = document.getElementById('recipes');
    const catListEl = document.getElementById('cat-list');
    const searchEl  = document.getElementById('search');
    const countEl   = document.getElementById('results-count');

    // simple local favorites/ratings
    const favKey = 'wp_favorites';
    const rateKey = 'wp_ratings';
    const favorites = new Set(JSON.parse(localStorage.getItem(favKey) || '[]'));
    const ratings = JSON.parse(localStorage.getItem(rateKey) || '{}');

    // gather categories
    const allCats = Array.from(new Set(demo.flatMap(r=>r.cats))).sort();

    // render category sidebar
    const state = { cats: new Set(), view: 'all', q: '' };

    function renderCats(){
      catListEl.innerHTML = allCats.map(c => `
        <li><label class="cat"><input type="checkbox" value="${c}"> ${c}</label></li>
      `).join('');
      catListEl.querySelectorAll('input[type="checkbox"]').forEach(cb=>{
        cb.addEventListener('change', ()=>{
          if (cb.checked) state.cats.add(cb.value); else state.cats.delete(cb.value);
          renderRecipes();
        });
      });
    }

    function card(r){
      const rVal = ratings[r.id] ?? r.rating;
      const fav = favorites.has(r.id);
      const tags = r.cats.map(t=>`<span class="pill">${t}</span>`).join('');
      return `
        <div class="recipe-card">
          <img src="${r.img}" alt="">
          <div class="rc-body">
            <div class="rc-title">
              <h3>${r.title}</h3>
              <button class="icon fav ${fav?'on':''}" data-fav="${r.id}" title="Favorite">★</button>
            </div>
            <div class="stars" data-id="${r.id}" aria-label="Rating">
              ${[1,2,3,4,5].map(n=>`<button data-rate="${n}" class="${n<=rVal?'on':''}">★</button>`).join('')}
            </div>
            <div class="tags">${tags}</div>
            <div class="rc-actions">
              <a class="btn small alt" href="/weekplan.html">Add to Weekplan</a>
              <button class="btn small" data-save="${r.id}">Save adjusted</button>
            </div>
          </div>
        </div>
      `;
    }

    function matchesFilters(r){
      if (state.q && !r.title.toLowerCase().includes(state.q)) return false;
      if (state.cats.size){
        for (const c of state.cats){ if (!r.cats.includes(c)) return false; }
      }
      if (state.view === 'favorites') return favorites.has(r.id);
      if (state.view === 'mine') return r.mine === true;
      return true;
    }

    function renderRecipes(){
      const list = demo.filter(matchesFilters);
      countEl.textContent = list.length + (list.length === 1 ? ' recipe' : ' recipes');
      recipesEl.innerHTML = list.map(card).join('') || '<p class="muted">No recipes match.</p>';

      // wire favorites
      recipesEl.querySelectorAll('[data-fav]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const id = btn.dataset.fav;
          if (favorites.has(id)) favorites.delete(id); else favorites.add(id);
          localStorage.setItem(favKey, JSON.stringify(Array.from(favorites)));
          renderRecipes();
        });
      });

      // wire ratings
      recipesEl.querySelectorAll('.stars').forEach(stars=>{
        stars.querySelectorAll('button').forEach(b=>{
          b.addEventListener('click', ()=>{
            ratings[stars.dataset.id] = +b.dataset.rate;
            localStorage.setItem(rateKey, JSON.stringify(ratings));
            renderRecipes();
          });
        });
      });

      // save adjusted (demo UX only)
      recipesEl.querySelectorAll('[data-save]').forEach(b=>{
        b.addEventListener('click', ()=>{
          alert('Saved your adjusted version. (In production, this writes to your Supabase account.)');
        });
      });
    }

    // quick view buttons
    document.querySelectorAll('.pill[data-view]').forEach(b=>{
      b.addEventListener('click', ()=>{
        state.view = b.dataset.view;
        renderRecipes();
      });
    });

    // search
    searchEl.addEventListener('input', ()=>{
      state.q = searchEl.value.trim().toLowerCase();
      renderRecipes();
    });

    renderCats();
    renderRecipes();
  </script>
</body>
</html>
